---
// Pagina Saldi Dedicata con integrazione CMS e Filtri Categoria
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import OptimizedImage from '../components/OptimizedImage.astro';
import { getCollection, getEntry } from 'astro:content';

// Leggi le impostazioni dei saldi
const saldiSettings = await getEntry('saldi-settings', 'saldi-settings');

// Leggi i dati dal CMS
let saldiPosts = [];
let saldiHero = [];
let prodottiSaldi = [];
let categorieSaldi = [];

try {
  // Prova a leggere dal CMS
  saldiPosts = await getCollection('saldi-posts');
  saldiHero = await getCollection('saldi-hero');
  prodottiSaldi = await getCollection('prodotti-saldi');
  categorieSaldi = await getCollection('categorie-saldi');
  
  // Debug: log per verificare che i dati vengano letti
  console.log('üîç Prodotti caricati:', prodottiSaldi.length);
  console.log('üîç Categorie caricate:', categorieSaldi.length);
  console.log('üîç Posts caricati:', saldiPosts.length);
  console.log('üîç Hero caricati:', saldiHero.length);
  
} catch (error) {
  console.log('‚ùå Errore CMS:', error.message);
  console.log('üîÑ Uso dati di fallback');
}

// Dati delle impostazioni con conversione sicura dei booleani
const saldiAttivi = saldiSettings?.data?.saldiAttivi === true || saldiSettings?.data?.saldiAttivi === 'true';
const messaggioGlobale = saldiSettings?.data?.messaggioGlobale || "";
const coloreTema = saldiSettings?.data?.coloreTema ?? "#ddbb76";
const emailOrdini = saldiSettings?.data?.emailOrdini ?? "keluafashion@hotmail.it";
const telefonoOrdini = saldiSettings?.data?.telefonoOrdini ?? "0882302070";

// Debug per verificare i valori
console.log('üîß Debug Impostazioni Saldi:');
console.log('- saldiAttivi (raw):', saldiSettings?.data?.saldiAttivi);
console.log('- saldiAttivi (processed):', saldiAttivi);
console.log('- messaggioGlobale:', messaggioGlobale);
console.log('- coloreTema:', coloreTema);

// Fallback data se il CMS non √® ancora configurato
const saldiHeroFallback = {
  titolo: "üî• Saldi Straordinari",
  sottotitolo: "Scopri le nostre offerte imperdibili",
  descrizione: "Eleganza e stile con sconti fino al 70%. Approfitta delle nostre promozioni esclusive su abiti da cerimonia e sportswear di qualit√†.",
  immagineBackground: "/uploads/optimized/background.webp",
  scontoMax: "70%",
  attivo: saldiAttivi
};

// Usa i dati del CMS se disponibili, altrimenti usa i fallback
const saldiHeroData = saldiHero.length > 0 
  ? saldiHero.find(hero => hero.data.attivo)?.data || saldiHeroFallback
  : saldiHeroFallback;

// Statistiche dinamiche
const numeroTotaleProdotti = prodottiSaldi.length;
const scontoMassimoCalcolato = prodottiSaldi.length > 0 
  ? Math.max(...prodottiSaldi.map(prod => {
      const sconto = Math.round(((prod.data.prezzoOriginale - prod.data.prezzoScontato) / prod.data.prezzoOriginale) * 100);
      return sconto || 0;
    }))
  : 70;

// Applica il colore tema personalizzato
const temaColore = coloreTema || "#ddbb76";

// Filtro e ordinamento Post Saldi
const dataOggi = new Date();
const saldiPostsFiltrati = saldiPosts
  .filter(post => {
    if (!post.data.attivo) return false;
    
    // Se ha date, controlla validit√†
    if (post.data.dataInizio || post.data.dataFine) {
      const dataInizio = post.data.dataInizio ? new Date(post.data.dataInizio) : new Date('1900-01-01');
      const dataFine = post.data.dataFine ? new Date(post.data.dataFine) : new Date('2100-12-31');
      
      return dataOggi >= dataInizio && dataOggi <= dataFine;
    }
    
    // Se non ha date, √® sempre valido se attivo
    return true;
  })
  .sort((a, b) => {
    // Ordina per ordinamento se presente, altrimenti per data di inizio (pi√π recente prima)
    if (a.data.ordinamento && b.data.ordinamento) {
      return a.data.ordinamento - b.data.ordinamento;
    }
    if (a.data.dataInizio && b.data.dataInizio) {
      return new Date(b.data.dataInizio).getTime() - new Date(a.data.dataInizio).getTime();
    }
    return 0;
  });

// Funzione helper per formattare le date
function formatDateRange(dataInizio, dataFine) {
  const options = { day: 'numeric', month: 'long' };
  
  if (!dataInizio && !dataFine) return null;
  
  if (dataInizio && dataFine) {
    const inizio = new Date(dataInizio).toLocaleDateString('it-IT', options);
    const fine = new Date(dataFine).toLocaleDateString('it-IT', options);
    return `Dal ${inizio} al ${fine}`;
  }
  
  if (dataInizio) {
    const inizio = new Date(dataInizio).toLocaleDateString('it-IT', options);
    return `Dal ${inizio}`;
  }
  
  if (dataFine) {
    const fine = new Date(dataFine).toLocaleDateString('it-IT', options);
    return `Fino al ${fine}`;
  }
  
  return null;
}

// SEO data per saldi
const seoData = {
  title: "Saldi Kelua - Offerte Speciali su Abbigliamento di Qualit√†",
  description: `Scopri i saldi Kelua a San Giovanni Rotondo! Offerte speciali su abbigliamento uomo e donna, abiti da cerimonia e sportswear. ${prodottiSaldi.length}+ articoli in promozione.`,
  keywords: [
    "saldi abbigliamento San Giovanni Rotondo",
    "offerte Kelua",
    "sconti abbigliamento uomo donna",
    "promozioni abiti cerimonia",
    "saldi sportswear",
    "offerte speciali Kelua",
    "sconti moda San Giovanni Rotondo",
    "saldi abbigliamento Puglia",
    "promozioni vestiti",
    "outlet abbigliamento"
  ],
  ogImage: "/uploads/optimized/IMG_2357.webp",
  jsonLD: {
    "@context": "https://schema.org",
    "@type": "OfferCatalog",
    "@id": "https://kelua.it/saldi/#catalog",
    "name": "Saldi Kelua - Offerte Speciali",
    "description": "Collezione di offerte speciali e saldi su abbigliamento di qualit√† per uomo e donna.",
    "url": "https://kelua.it/saldi",
    "mainEntity": {
      "@type": "LocalBusiness",
      "@id": "https://kelua.it/#business",
      "name": "Kelua"
    },
    "breadcrumb": {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://kelua.it"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Saldi",
          "item": "https://kelua.it/saldi"
        }
      ]
    }
  }
};
---

<Layout 
  title={seoData.title}
  description={seoData.description}
  keywords={seoData.keywords}
  ogImage={seoData.ogImage}
  canonicalURL="https://kelua.it/saldi"
  jsonLD={seoData.jsonLD}
>
  <main>
    <Navbar />
    
    {!saldiAttivi ? (
      <!-- Messaggio Saldi Non Attivi -->
      <section class="saldi-disattivati">
        <div class="container">
          <div class="message-content">
            <h1>üîÑ Saldi Temporaneamente Non Disponibili</h1>
            <p>I nostri saldi non sono attualmente attivi. Torna presto per scoprire le nostre offerte speciali!</p>
            <a href="/" class="btn-home">Torna alla Homepage</a>
          </div>
        </div>
      </section>
    ) : (
      <>
        <!-- Hero Section Saldi -->
    <section class="saldi-hero">
      <div class="hero-background">
        <OptimizedImage
          src={saldiHeroData.immagineBackground || "/uploads/optimized/background.webp"}
          alt="Saldi Kelua"
          width={1920}
          height={1080}
          loading="eager"
          class="hero-bg-image"
          sizes="100vw"
        />
        <div class="hero-overlay"></div>
      </div>
      
      <div class="hero-content">
        <div class="container">
          <div class="hero-text">
            <h1>{saldiHeroData.titolo}</h1>
            <h2>{saldiHeroData.sottotitolo}</h2>
            <p>{saldiHeroData.descrizione}</p>
            <div class="hero-stats">
              <div class="stat">
                <span class="number">{numeroTotaleProdotti}</span>
                <span class="label">Prodotti in Saldo</span>
              </div>
              <div class="stat">
                <span class="number">{scontoMassimoCalcolato || saldiHeroData.scontoMax}%</span>
                <span class="label">Sconto Massimo</span>
              </div>
            </div>
          </div>
        </div>      </div>    </section>    <!-- Messaggio Globale Saldi -->
    {messaggioGlobale && messaggioGlobale.trim() !== "" && (
      <section class="messaggio-globale">
        <div class="container">
          <div class="messaggio-content">
            <p>{messaggioGlobale}</p>
          </div>
        </div>
      </section>    )}

    <!-- Post Saldi / News -->
    {saldiPostsFiltrati.length > 0 && (
      <section class="saldi-posts">
        <div class="container">
          <div class="posts-header">
            <h2>üìù Novit√† sui Saldi</h2>
            <p>Scopri le ultime novit√† e promozioni speciali</p>
          </div>
          
          <div class="posts-grid">
            {saldiPostsFiltrati.map((post, index) => {
              const dateRange = formatDateRange(post.data.dataInizio, post.data.dataFine);
              
              return (
                <article class="post-card" data-delay={`${index * 0.1}`}>
                  <div class="post-content">
                    <div class="post-header">
                      <h3>{post.data.titolo}</h3>
                      {post.data.sottotitolo && (
                        <h4>{post.data.sottotitolo}</h4>
                      )}
                    </div>
                    
                    {post.data.descrizione && (
                      <p class="post-description">{post.data.descrizione}</p>
                    )}
                    
                    {dateRange && (
                      <div class="post-date">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        <span>{dateRange}</span>
                      </div>
                    )}
                  </div>
                  
                  <div class="post-number">
                    {String(index + 1).padStart(2, '0')}
                  </div>
                </article>
              );
            })}
          </div>
        </div>
      </section>
    )}    <!-- Sistema di Selezione a Step: Genere ‚Üí Categoria ‚Üí Prodotti -->
    <section class="selezione-saldi">
      <div class="container">
        <!-- Step 1: Selezione Genere -->
        <div id="step-genere" class="step-container active">
          <h2>Seleziona il Genere</h2>
          <p class="step-description">Scegli per chi stai cercando i prodotti in saldo</p>
          <div class="genere-grid">
            <div class="genere-card" data-genere="Donna">
              <h3>Donna</h3>
              <p>Scopri le offerte per donna</p>
              <div class="genere-count">{prodottiSaldi.filter(p => p.data.genere === "Donna" && p.data.disponibile).length} prodotti</div>
            </div>
            <div class="genere-card" data-genere="Uomo">
              <h3>Uomo</h3>
              <p>Scopri le offerte per uomo</p>
              <div class="genere-count">{prodottiSaldi.filter(p => p.data.genere === "Uomo" && p.data.disponibile).length} prodotti</div>
            </div>
          </div>
        </div>

        <!-- Step 2: Selezione Categoria -->
        <div id="step-categoria" class="step-container">
          <div class="step-header">
            <button class="btn-back" onclick="tornaAlGenere()">
              <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
              </svg>
              Indietro
            </button>
            <div class="step-info">
              <div class="breadcrumb">
                <span class="breadcrumb-item">Genere: <strong id="breadcrumb-genere">-</strong></span>
                <span class="breadcrumb-separator">‚Üí</span>
                <span class="breadcrumb-item active">Categoria</span>
              </div>
              <h2>üè∑Ô∏è Seleziona la Categoria</h2>
              <p class="step-description">Scegli il tipo di prodotto che ti interessa</p>
            </div>
          </div>
          
          <div class="categorie-grid" id="categorie-per-genere">
            {/* Le categorie verranno popolate dinamicamente via JavaScript */}
          </div>
        </div>

        <!-- Step 3: Visualizzazione Prodotti -->
        <div id="step-prodotti" class="step-container">
          <div class="step-header">
            <button class="btn-back" onclick="tornaAlleCategorie()">
              <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
              </svg>
              Indietro
            </button>
            <div class="step-info">
              <div class="breadcrumb">
                <span class="breadcrumb-item">Genere: <strong id="breadcrumb-genere-prodotti">-</strong></span>
                <span class="breadcrumb-separator">‚Üí</span>
                <span class="breadcrumb-item">Categoria: <strong id="breadcrumb-categoria">-</strong></span>
                <span class="breadcrumb-separator">‚Üí</span>
                <span class="breadcrumb-item active">Prodotti</span>
              </div>
              <h2 id="titolo-prodotti">üõçÔ∏è Prodotti in Saldo</h2>
              <div class="descrizione-container">
              <p class="step-description" id="descrizione-prodotti">I migliori prodotti selezionati per te</p>
                <span class="prodotti-trovati" id="prodotti-trovati-header" style="display: none;">‚Ä¢ <span id="numero-prodotti-header">0</span> prodotti trovati</span>
              </div>
            </div>
          </div>
          
          <div class="prodotti-grid" id="prodotti-filtrati">
            {/* I prodotti verranno popolati dinamicamente via JavaScript */}
          </div>
        </div>
      </div>
    </section>    <!-- Dati JSON per JavaScript -->
    <script type="application/json" id="saldi-data" set:html={JSON.stringify({
      categorie: categorieSaldi.filter(cat => cat.data.attivo).map(cat => ({
        nome: cat.data.nome,
        emoji: cat.data.emoji || "üõçÔ∏è",
        genere: cat.data.genere,
        descrizione: cat.data.descrizione,
        sconto: cat.data.sconto,
        immagine: cat.data.immagine,
        attivo: cat.data.attivo
      })),
      prodotti: prodottiSaldi.filter(prod => prod.data.disponibile).map(prod => ({
        nome: prod.data.nome,
        categoria: prod.data.categoria,
        genere: prod.data.genere,
        descrizione: prod.data.descrizione,
        prezzoOriginale: prod.data.prezzoOriginale,
        prezzoScontato: prod.data.prezzoScontato,
        immagine: prod.data.immagine,
        taglie: prod.data.taglie,
        disponibile: prod.data.disponibile,
        nuovo: prod.data.nuovo,
        limitedTime: prod.data.limitedTime
      })),
      colore: temaColore
    })}></script>

    <!-- Call to Action -->
    <section class="cta-saldi">
      <div class="container">
        <div class="cta-content">
          <h2>Non Perdere le Nostre Offerte!</h2>
          <p>Vieni a trovarci in negozio per scoprire tutti i prodotti in saldo o contattaci per maggiori informazioni.</p>
          <div class="cta-buttons">
            <a href="#contatti" class="btn-primary">Vieni in Negozio</a>
            <a href="tel:+390882302070" class="btn-secondary">Chiama Subito</a>
          </div>
        </div>
      </div>
    </section>      </>
    )}

    <Footer />
  </main>
</Layout>

<style define:vars={{ temaColore }}>
  /* Variabili CSS dinamiche */
  :root {
    --tema-colore: var(--temaColore);
  }

  /* Saldi Disattivati */
  .saldi-disattivati {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
    color: white;
    text-align: center;
    padding: 100px 0;
  }

  .message-content h1 {
    font-size: 3rem;
    font-weight: 600;
    margin-bottom: 20px;
    color: #ddbb76;
  }

  .message-content p {
    font-size: 1.2rem;
    color: #ccc;
    margin-bottom: 30px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .btn-home {
    display: inline-block;
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    color: #1a1a1a;
    padding: 15px 30px;
    border-radius: 25px;
    text-decoration: none;
    font-weight: 600;
    transition: transform 0.3s ease;
  }

  .btn-home:hover {
    transform: translateY(-2px);
  }
  /* Messaggio Globale */
  .messaggio-globale {
    background: linear-gradient(135deg, #ddbb76, #b8941f);
    color: #1a1a1a;
    padding: 20px 0;
    text-align: center;
    font-weight: 600;
    font-size: 1.1rem;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    border-bottom: 2px solid rgba(26, 26, 26, 0.1);
  }

  .messaggio-globale p {
    margin: 0;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
  }

  /* Saldi Hero */
  .saldi-hero {
    min-height: 80vh;
    position: relative;
    display: flex;
    align-items: center;
    overflow: hidden;
  }

  .hero-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -2;
  }

  .hero-bg-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(0.4) contrast(1.1);
  }

  .hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, 
      rgba(0, 0, 0, 0.7) 0%, 
      rgba(0, 0, 0, 0.5) 50%, 
      rgba(0, 0, 0, 0.8) 100%);
    z-index: -1;
  }

  .hero-content {
    position: relative;
    z-index: 1;
    width: 100%;
    padding: 140px 0 80px;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .hero-text {
    text-align: center;
    color: white;
    max-width: 900px;
    margin: 0 auto;
    position: relative;
  }

  /* Backdrop per migliorare la leggibilit√† */
  .hero-text::before {
    content: '';
    position: absolute;
    top: -40px;
    left: -60px;
    right: -60px;
    bottom: -40px;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    z-index: -1;
  }

  .hero-text h1 {
    font-family: 'Glida Display Regular', 'Playfair Display', serif;
    font-size: 4.5rem;
    font-weight: 300;
    margin-bottom: 20px;
    color: #ffffff;
    letter-spacing: 3px;
    text-shadow: 0 2px 20px rgba(0, 0, 0, 0.5);
  }

  .hero-text h2 {
    font-family: 'Inter', -apple-system, sans-serif;
    font-size: 1.5rem;
    font-weight: 300;
    color: rgba(212, 175, 55, 0.9);
    margin-bottom: 30px;
    letter-spacing: 1px;
  }

  .hero-text p {
    font-family: 'Inter', -apple-system, sans-serif;
    font-size: 1.1rem;
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.8;
    margin-bottom: 50px;
    font-weight: 300;
  }

  .hero-stats {
    display: flex;
    justify-content: center;
    gap: 60px;
    margin-top: 40px;
  }

  .stat {
    text-align: center;
    position: relative;
  }

  .stat .number {
    display: block;
    font-family: 'Glida Display Regular', 'Playfair Display', serif;
    font-size: 3rem;
    font-weight: 300;
    color: #ddbb76;
    margin-bottom: 8px;
    letter-spacing: 2px;
  }

  .stat .label {
    font-family: 'Inter', -apple-system, sans-serif;
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.6);
    text-transform: uppercase;
    letter-spacing: 1.5px;
    font-weight: 300;
  }

  .stat::after {
    content: '';
    position: absolute;
    top: 50%;
    right: -30px;
    width: 1px;
    height: 40px;
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-50%);
  }

  .stat:last-child::after {
    display: none;
  }

  /* Filtri Prodotti */
  .filtri-prodotti {
    padding: 80px 0 60px;
    background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
  }

  .filtri-prodotti h2 {
    font-size: 2.2rem;
    font-weight: 600;
    text-align: center;
    margin-bottom: 40px;
    color: white;
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .filtri-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 16px;
    max-width: 1000px;
    margin: 0 auto;
  }

  .filtro-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px 24px;
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px);
    border: 2px solid rgba(212, 175, 55, 0.2);
    border-radius: 15px;
    color: #ccc;
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .filtro-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .filtro-btn:hover::before {
    left: 100%;
  }

  .filtro-btn:hover {
    border-color: rgba(212, 175, 55, 0.5);
    background: rgba(212, 175, 55, 0.1);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(212, 175, 55, 0.2);
  }
  .filtro-btn.active {
    background: linear-gradient(135deg, var(--tema-colore, #ddbb76), #b8941f);
    border-color: var(--tema-colore, #ddbb76);
    color: #1a1a1a;
    box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
  }
  .filtro-btn.active:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 35px rgba(212, 175, 55, 0.4);
  }

  .filtro-icon {
    font-size: 1.4rem;
    line-height: 1;
  }

  .filtro-text {
    font-weight: 600;
    white-space: nowrap;
  }

  .filtro-count {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.85rem;
    font-weight: 700;
    min-width: 24px;
    text-align: center;
  }

  .filtro-btn.active .filtro-count {
    background: rgba(255, 255, 255, 0.3);
  }
  /* Categorie Saldi Dinamiche */
  .categorie-saldi {
    padding: 100px 0;
    background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
  }

  .categorie-saldi h2 {
    font-size: 2.5rem;
    font-weight: 600;
    text-align: center;
    margin-bottom: 60px;
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .categorie-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 30px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .categoria-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(212, 175, 55, 0.2);
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
  }

  .categoria-card:hover {
    transform: translateY(-10px);
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(212, 175, 55, 0.4);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
  }

  .categoria-image {
    position: relative;
    height: 200px;
    overflow: hidden;
  }

  .categoria-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .categoria-card:hover .categoria-image img {
    transform: scale(1.05);
  }
  .sconto-overlay {
    position: absolute;
    top: 20px;
    right: 20px;
    background: linear-gradient(45deg, var(--tema-colore), color-mix(in srgb, var(--tema-colore) 80%, black));
    color: white;
    padding: 10px 20px;
    border-radius: 25px;
    font-weight: 700;
    font-size: 1.1rem;
  }

  .genere-badge {
    position: absolute;
    top: 20px;
    left: 20px;
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    color: #1a1a1a;
    padding: 8px 16px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.9rem;
  }

  .categoria-content {
    padding: 30px;
  }

  .categoria-content h3 {
    font-size: 1.5rem;
    font-weight: 600;
    color: white;
    margin-bottom: 12px;
  }

  .categoria-content p {
    color: #ccc;
    line-height: 1.6;
    margin-bottom: 20px;
  }

  .categoria-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .articoli {
    color: #ccc;
    font-size: 0.9rem;
  }
  .sconto-text {
    color: var(--tema-colore);
    font-weight: 600;
    font-size: 1rem;
  }
  /* Sistema di Selezione a Step */
  .selezione-saldi {
    padding: 80px 0;
    background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
    min-height: 80vh;
  }

  .step-container {
    display: none;
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.5s ease;
  }

  .step-container.active {
    display: block;
    opacity: 1;
    transform: translateY(0);
  }

  .step-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 30px;
    margin-bottom: 40px;
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
    padding: 0 20px;
  }

  .btn-back {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    backdrop-filter: blur(20px);
    border: 2px solid rgba(212, 175, 55, 0.3);
    border-radius: 15px;
    color: #ddbb76;
    padding: 12px 20px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    position: absolute;
    left: 20px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    min-width: 120px;
  }

  .btn-back:hover {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(212, 175, 55, 0.1) 100%);
    border-color: rgba(212, 175, 55, 0.6);
    transform: translateY(-50%);
    box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
    color: #f1c40f;
  }

  .btn-back svg {
    transition: transform 0.3s ease;
  }

  .btn-back:hover svg {
    transform: translateX(-2px);
  }

  .step-info {
    flex: 1;
    text-align: center;
    position: relative;
  }

  .step-info h2 {
    font-size: 2.2rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0;
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-align: center;
  }
  .step-info .step-description {
    color: #ccc;
    font-size: 1.1rem;
    margin: 8px 0 0 0;
    text-align: center;
  }

  /* Titoli degli Step */
  .step-container h2 {
    font-size: 2.5rem;
    font-weight: 600;
    text-align: center;
    margin-bottom: 20px;
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .step-container .step-description {
    text-align: center;
    color: #ccc;
    font-size: 1.2rem;
    margin-bottom: 40px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Step 1: Selezione Genere */
  .genere-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 40px;
    max-width: 800px;
    margin: 0 auto;
  }

  .genere-card {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%) !important;
    backdrop-filter: blur(20px) !important;
    padding: 45px 35px !important;
    border-radius: 25px !important;
    text-align: center !important;
    cursor: pointer !important;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    border: 2px solid rgba(212, 175, 55, 0.3) !important;
    box-shadow: 
      0 15px 35px rgba(0, 0, 0, 0.4),
      0 5px 15px rgba(212, 175, 55, 0.1) !important;
    user-select: none !important;
    position: relative !important;
    overflow: hidden !important;
    color: #e0e0e0 !important;
  }

  .genere-card::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 4px !important;
    background: linear-gradient(90deg, #ddbb76, #f1c40f, #ddbb76) !important;
    transform: scaleX(0) !important;
    transition: transform 0.3s ease !important;
  }

  .genere-card:hover::before {
    transform: scaleX(1) !important;
  }

  .genere-card:hover {
    transform: translateY(-12px) scale(1.03) !important;
    box-shadow: 
      0 25px 60px rgba(0, 0, 0, 0.6),
      0 10px 30px rgba(212, 175, 55, 0.3) !important;
    border-color: rgba(212, 175, 55, 0.6) !important;
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.98) 0%, rgba(13, 13, 13, 0.95) 100%) !important;
  }

  .genere-card:active {
    transform: translateY(-8px) scale(1.01) !important;
  }

  .genere-card.selected {
    border-color: #ddbb76 !important;
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(241, 196, 15, 0.1) 100%) !important;
    transform: translateY(-8px) scale(1.02) !important;
    box-shadow: 
      0 20px 50px rgba(212, 175, 55, 0.4),
      0 8px 25px rgba(212, 175, 55, 0.2) !important;
  }

  .genere-icon {
    font-size: 4.5rem !important;
    margin-bottom: 25px !important;
    display: block !important;
    transition: all 0.3s ease !important;
  }

  .genere-card:hover .genere-icon {
    transform: scale(1.1) rotate(5deg) !important;
  }

  .genere-card h3 {
    font-size: 2rem !important;
    font-weight: 700 !important;
    color: white !important;
    margin-bottom: 12px !important;
    line-height: 1.2 !important;
  }

  .genere-card p {
    color: #ccc !important;
    font-size: 1.1rem !important;
    margin-bottom: 25px !important;
    line-height: 1.5 !important;
  }

  .genere-count {
    background: linear-gradient(45deg, #ddbb76, #f1c40f) !important;
    color: #1a1a1a !important;
    padding: 10px 20px !important;
    border-radius: 25px !important;
    font-weight: 700 !important;
    font-size: 1rem !important;
    display: inline-block !important;
    box-shadow: 0 6px 20px rgba(212, 175, 55, 0.3) !important;
    transition: all 0.3s ease !important;
  }

  .genere-card:hover .genere-count {
    transform: scale(1.05) !important;
    box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4) !important;
  }

  /* Sistema di Selezione Saldi - Responsivo - RIMOSSO DUPLICATO */

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* Step Containers */
  .step-container {
    display: none;
    text-align: center;
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.5s ease;
  }

  .step-container.active {
    display: block;
    opacity: 1;
    transform: translateY(0);
  }

  .step-container h2 {
    font-size: 2.2rem;
    font-weight: 700;
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 12px;
    text-align: center;
  }

  .step-description {
    font-size: 1.1rem;
    color: #ccc;
    margin-bottom: 40px;
    text-align: center;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .descrizione-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 40px;
    text-align: center;
    position: relative;
  }

  .descrizione-container .step-description {
    margin-bottom: 0;
    flex-shrink: 0;
    text-align: center;
  }

  .prodotti-trovati {
    background: rgba(212, 175, 55, 0.1);
    padding: 4px 10px;
    border-radius: 12px;
    border: 1px solid rgba(212, 175, 55, 0.2);
    white-space: nowrap;
    font-size: 0.8rem;
    color: #ddbb76;
    font-weight: 600;
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
  }

  /* Step 1: Selezione Genere */
  .genere-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px;
    max-width: 800px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* Step 2: Selezione Categoria */
  .categorie-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* Step 3: Visualizzazione Prodotti - Layout E-commerce Professionale */
  .prodotti-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 320px));
    gap: 16px;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
    justify-content: center;
  }

  /* Card Prodotti Compatte - Design E-commerce Professionale */
  .prodotto-card-compact {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 15px;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
    cursor: pointer;
    width: 320px;
    max-width: 320px;
    min-width: 320px;
    min-height: 440px;
    margin: 0 auto;
  }

  .prodotto-card-compact:hover {
    transform: translateY(-5px);
    border-color: rgba(255, 215, 0, 0.5);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6), 0 5px 15px rgba(255, 215, 0, 0.2);
  }

  .prodotto-image-compact {
    position: relative;
    height: 200px; /* Aumentata da 180px per dare pi√π spazio */
    overflow: hidden;
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%);
    display: flex; /* Aggiunto per centrare l'immagine */
    align-items: center; /* Centra verticalmente */
    justify-content: center; /* Centra orizzontalmente */
  }

  .prodotto-image-compact img {
    width: auto; /* Cambiato da 100% */
    height: auto; /* Cambiato da 100% */
    max-width: 100%; /* Aggiunto per rispettare la larghezza del container */
    max-height: 100%; /* Aggiunto per rispettare l'altezza del container */
    object-fit: contain; /* Cambiato da cover a contain per mostrare l'immagine completa */
    transition: transform 0.3s ease;
  }

  .prodotto-card-compact:hover .prodotto-image-compact img {
    transform: scale(1.05);
  }

  .badges-compact {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    z-index: 3;
  }

  .badges-compact .badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 0.7rem;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  }

  .badges-compact .badge.nuovo {
    background: linear-gradient(45deg, #27ae60, #2ecc71);
    color: white;
  }

  .badges-compact .badge.limited {
    background: linear-gradient(45deg, #e67e22, #f39c12);
    color: white;
  }

  .badges-compact .badge.sconto {
    background: linear-gradient(45deg, #ddbb76, #c6ae6a);
    color: #1a1a1a;
    font-weight: 800;
  }

  .prodotto-content-compact {
    padding: 16px;
    color: #e0e0e0;
  }

  .prodotto-header-compact {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 10px;
    gap: 8px;
  }

  .prodotto-header-compact h3 {
    font-size: 1rem;
    font-weight: 700;
    color: #e0e0e0;
    margin: 0;
    line-height: 1.3;
    flex: 1;
    min-width: 0;
  }

  .prodotto-header-compact .categoria-tag {
    background: linear-gradient(45deg, rgba(221, 187, 118, 0.15) 0%, rgba(221, 187, 118, 0.1) 100%);
    color: #ddbb76;
    padding: 3px 6px;
    border-radius: 8px;
    font-size: 0.7rem;
    font-weight: 600;
    border: 1px solid rgba(255, 215, 0, 0.3);
    white-space: nowrap;
    flex-shrink: 0;
  }

  .prezzi-compact {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 12px;
    flex-wrap: wrap;
    padding: 8px;
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 215, 0, 0.05) 100%);
    border-radius: 8px;
    border: 1px solid rgba(255, 215, 0, 0.2);
  }

  .prezzi-compact .prezzo-originale {
    color: #888;
    text-decoration: line-through;
    font-size: 0.8rem;
    font-weight: 500;
  }

  .prezzi-compact .prezzo-scontato {
    color: #ddbb76;
    font-size: 1.1rem;
    font-weight: 800;
  }

  .prezzi-compact .risparmio {
    background: linear-gradient(45deg, #27ae60, #2ecc71);
    color: white;
    padding: 2px 6px;
    border-radius: 6px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: auto;
  }

  .taglie-compact {
    margin-bottom: 12px;
  }

  .taglie-compact .taglie-label {
    display: block;
    color: #ccc;
    font-weight: 600;
    margin-bottom: 4px;
    font-size: 0.8rem;
  }

  .taglie-compact .taglie-list {
    display: flex;
    gap: 4px;
    flex-wrap: wrap;
  }

  .taglie-compact .taglia {
    background: rgba(255, 215, 0, 0.15);
    color: #e0e0e0;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    border: 1px solid rgba(255, 215, 0, 0.3);
    transition: all 0.3s ease;
    min-width: 24px;
    text-align: center;
  }

  .prodotto-actions-compact {
    display: flex;
    gap: 8px;
  }

  .btn-whatsapp-compact {
    flex: 1;
    background: linear-gradient(45deg, #25D366, #128C7E);
    color: white;
    padding: 8px 12px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    transition: all 0.3s ease;
    font-size: 0.8rem;
  }

  .btn-whatsapp-compact:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
  }

  .btn-call-compact {
    background: linear-gradient(45deg, #ddbb76, #c6ae6a);
    color: #1a1a1a;
    padding: 8px 10px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    transition: all 0.3s ease;
    font-size: 0.7rem;
    flex-shrink: 0;
  }

  .btn-call-compact:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
  }

  /* Breadcrumb Navigation */
  .breadcrumb {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 25px;
    font-size: 0.9rem;
    color: #ccc;
  }

  .breadcrumb-item {
    color: #ccc;
  }

  .breadcrumb-item.active {
    color: #ddbb76;
    font-weight: 600;
  }

  .breadcrumb-separator {
    color: #ccc;
    margin: 0 5px;
  }

  /* Header con pulsante back */
  .step-header {
    position: relative;
    margin-bottom: 40px;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 80px;
  }

  .step-info {
    width: 100%;
    text-align: center;
    flex: 1;
  }



  /* RESPONSIVE DESIGN */
  @media (max-width: 1024px) {
    .prodotti-grid {
      grid-template-columns: repeat(auto-fill, minmax(280px, 280px));
      gap: 14px;
    }

    .prodotto-card-compact {
      width: 280px;
      max-width: 280px;
      min-width: 280px;
    }

    .prodotti-trovati {
      position: static;
      transform: none;
      margin-top: 10px;
      align-self: center;
    }

    .descrizione-container {
      flex-direction: column;
      gap: 10px;
    }
  }

  @media (max-width: 900px) {
    .prodotti-grid {
      grid-template-columns: repeat(auto-fill, minmax(250px, 250px));
      gap: 12px;
    }

    .prodotto-card-compact {
      width: 250px;
      max-width: 250px;
      min-width: 250px;
    }
  }

  @media (max-width: 768px) {
    .selezione-saldi {
      padding: 60px 0;
    }

    .container {
      padding: 0 15px;
    }

    .step-container h2 {
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    .step-description {
      font-size: 1rem;
      margin-bottom: 30px;
    }

    .genere-grid {
      grid-template-columns: 1fr;
    gap: 20px;
      max-width: 400px;
    }

    .categorie-grid {
      grid-template-columns: 1fr;
      gap: 15px;
      max-width: none;
      padding: 0 10px;
    }

    .prodotti-grid {
      grid-template-columns: 1fr;
      gap: 16px;
      max-width: none;
      padding: 0 10px;
    }

    .prodotto-card-compact {
      width: 100% !important;
      max-width: 100% !important;
      min-width: auto !important;
    }

    .step-header {
      margin-bottom: 30px;
      padding-top: 60px;
    }



    .descrizione-container {
      flex-direction: column;
      gap: 12px;
      padding-bottom: 10px;
    }

    .prodotti-trovati {
      position: static !important;
      transform: none !important;
      align-self: center;
      margin-top: 8px;
      padding: 6px 12px !important;
      background: rgba(212, 175, 55, 0.15) !important;
      border-radius: 15px !important;
    }

    .breadcrumb {
      font-size: 0.8rem;
      margin-bottom: 20px;
    }

    .breadcrumb-item, .breadcrumb-separator {
      font-size: 0.8rem;
    }
  }

  @media (max-width: 480px) {
    .selezione-saldi {
      padding: 40px 0;
    }

    .step-container h2 {
      font-size: 1.5rem;
    }

    .step-description {
      font-size: 0.9rem;
      margin-bottom: 25px;
    }

    .genere-grid {
      gap: 15px;
      max-width: 350px;
    }

    .categorie-grid {
      gap: 12px;
    }

    .prodotti-grid {
      gap: 15px;
    }

    .btn-back {
      padding: 8px 14px;
      font-size: 0.8rem;
    }

    .breadcrumb {
      flex-direction: column;
      gap: 5px;
      text-align: center;
    }

    .breadcrumb-separator {
      display: none;
    }
  }

  .categoria-card-step {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%) !important;
    color: #e0e0e0 !important;
    border: 2px solid rgba(255, 215, 0, 0.4) !important;
    border-radius: 20px !important;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4), 0 5px 15px rgba(255, 215, 0, 0.2) !important;
    padding: 32px !important;
    display: flex !important;
    align-items: center !important;
    gap: 24px !important;
    backdrop-filter: blur(20px) !important;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    cursor: pointer !important;
    position: relative !important;
    overflow: hidden !important;
    min-height: 120px !important;
  }
  .categoria-card-step .categoria-icon {
    font-size: 2.5rem !important;
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 215, 0, 0.1) 100%) !important;
    color: #ddbb76 !important;
    border-radius: 20px !important;
    width: 70px !important;
    height: 70px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border: 1px solid rgba(255, 215, 0, 0.3) !important;
    transition: all 0.3s ease !important;
    flex-shrink: 0 !important;
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2) !important;
  }
  .categoria-card-step .categoria-info h3 {
    color: #e0e0e0 !important;
    font-size: 1.3rem !important;
    font-weight: 700 !important;
    margin-bottom: 8px !important;
  }
  .categoria-card-step .categoria-info p {
    color: #ccc !important;
    margin-bottom: 12px !important;
  }
  .categoria-card-step .sconto-badge {
    background: linear-gradient(45deg, #ddbb76, #c6ae6a) !important;
    color: #1a1a1a !important;
    border-radius: 12px !important;
    padding: 4px 10px !important;
    font-weight: 600 !important;
    font-size: 0.8rem !important;
    box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3) !important;
  }
  .categoria-card-step .prodotti-count {
    color: #ccc !important;
    font-size: 0.9rem !important;
    background: rgba(255, 215, 0, 0.1) !important;
    padding: 4px 8px !important;
    border-radius: 8px !important;
    border: 1px solid rgba(255, 215, 0, 0.2) !important;
  }

  .categoria-card-step::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 4px !important;
    background: linear-gradient(90deg, #ddbb76, #f1c40f, #ddbb76) !important;
    transform: scaleX(0) !important;
    transition: transform 0.3s ease !important;
  }

  .categoria-card-step:hover::before {
    transform: scaleX(1) !important;
  }

  .categoria-card-step:hover {
    transform: translateY(-8px) scale(1.02) !important;
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.98) 0%, rgba(13, 13, 13, 0.95) 100%) !important;
    border-color: rgba(255, 215, 0, 0.6) !important;
    box-shadow: 
      0 25px 60px rgba(0, 0, 0, 0.6),
      0 10px 30px rgba(255, 215, 0, 0.3) !important;
  }

  .categoria-card-step.selected {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(241, 196, 15, 0.05) 100%) !important;
    border-color: #ddbb76 !important;
    box-shadow: 
      0 15px 40px rgba(212, 175, 55, 0.2),
      0 5px 15px rgba(212, 175, 55, 0.1) !important;
    transform: translateY(-5px) scale(1.01) !important;
  }

  .categoria-icon {
    width: 80px !important;
    height: 80px !important;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%) !important;
    border-radius: 20px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 2.5rem !important;
    box-shadow: 
      0 8px 20px rgba(0, 0, 0, 0.1),
      inset 0 1px 3px rgba(255, 255, 255, 0.8) !important;
    transition: all 0.3s ease !important;
    flex-shrink: 0 !important;
  }

  .categoria-card-step:hover .categoria-icon {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.3) 0%, rgba(255, 215, 0, 0.2) 100%) !important;
    color: #ddbb76 !important;
    transform: scale(1.1) rotate(5deg) !important;
    border-color: rgba(255, 215, 0, 0.5) !important;
    box-shadow: 
      0 8px 25px rgba(255, 215, 0, 0.4),
      inset 0 1px 3px rgba(255, 255, 255, 0.1) !important;
  }

  .categoria-info {
    flex: 1 !important;
  }

  .categoria-info h3 {
    font-size: 1.4rem !important;
    font-weight: 700 !important;
    color: #1a1a1a !important;
    margin-bottom: 8px !important;
    line-height: 1.2 !important;
  }

  .categoria-info p {
    color: #666 !important;
    font-size: 0.95rem !important;
    margin-bottom: 15px !important;
    line-height: 1.5 !important;
  }

  .categoria-meta {
    display: flex !important;
    align-items: center !important;
    gap: 15px !important;
    flex-wrap: wrap !important;
  }

  .sconto-badge {
    background: linear-gradient(45deg, #ddbb76, #f1c40f) !important;
    color: #1a1a1a !important;
    padding: 6px 14px !important;
    border-radius: 20px !important;
    font-weight: 700 !important;
    font-size: 0.85rem !important;
    box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3) !important;
    transition: all 0.3s ease !important;
  }

  .categoria-card-step:hover .sconto-badge {
    transform: scale(1.05) !important;
    box-shadow: 0 6px 18px rgba(212, 175, 55, 0.4) !important;
  }

  .prodotti-count {
    color: #666 !important;
    font-size: 0.9rem !important;
    font-weight: 600 !important;
    background: rgba(212, 175, 55, 0.1) !important;
    padding: 4px 12px !important;
    border-radius: 15px !important;
    border: 1px solid rgba(212, 175, 55, 0.2) !important;
  }

  /* Stili speciali per "Tutti gli articoli" */
  .categoria-card-step.tutti-articoli {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.08) 0%, rgba(241, 196, 15, 0.04) 100%) !important;
    border: 2px solid rgba(212, 175, 55, 0.4) !important;
    position: relative !important;
    overflow: hidden !important;
  }

  .categoria-card-step.tutti-articoli::after {
    content: '' !important;
    position: absolute !important;
    top: -50% !important;
    left: -50% !important;
    width: 200% !important;
    height: 200% !important;
    background: linear-gradient(45deg, transparent, rgba(212, 175, 55, 0.1), transparent) !important;
    transform: rotate(45deg) translateX(-100%) !important;
    transition: transform 0.6s ease !important;
  }

  .categoria-card-step.tutti-articoli:hover::after {
    transform: rotate(45deg) translateX(100%) !important;
  }

  .categoria-card-step.tutti-articoli:hover {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.12) 0%, rgba(241, 196, 15, 0.06) 100%) !important;
    border-color: #ddbb76 !important;
    transform: translateY(-10px) scale(1.03) !important;
    box-shadow: 
      0 25px 60px rgba(212, 175, 55, 0.2),
      0 10px 30px rgba(212, 175, 55, 0.1) !important;
  }

  .categoria-card-step.tutti-articoli .categoria-icon {
    background: linear-gradient(135deg, #ddbb76 0%, #f1c40f 100%) !important;
    color: white !important;
    font-size: 2.8rem !important;
    box-shadow: 
      0 10px 25px rgba(212, 175, 55, 0.4),
      inset 0 1px 3px rgba(255, 255, 255, 0.3) !important;
  }

  .categoria-card-step.tutti-articoli:hover .categoria-icon {
    transform: scale(1.15) rotate(10deg) !important;
    box-shadow: 
      0 15px 35px rgba(212, 175, 55, 0.5),
      inset 0 1px 3px rgba(255, 255, 255, 0.4) !important;
  }

  .categoria-card-step.tutti-articoli .sconto-badge {
    background: linear-gradient(45deg, #e74c3c, #c0392b) !important;
    color: white !important;
    animation: pulse 2s infinite !important;
    box-shadow: 0 6px 18px rgba(231, 76, 60, 0.4) !important;
  }

  .categoria-card-step.tutti-articoli:hover .sconto-badge {
    transform: scale(1.1) !important;
    box-shadow: 0 8px 25px rgba(231, 76, 60, 0.5) !important;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
  }

  /* Step 3: Visualizzazione Prodotti */
  .prodotti-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .prodotto-card-final {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%) !important;
    color: #e0e0e0 !important;
    backdrop-filter: blur(20px) !important;
    border-radius: 20px !important;
    overflow: hidden !important;
    box-shadow: 
      0 15px 35px rgba(0, 0, 0, 0.4),
      0 5px 15px rgba(212, 175, 55, 0.1) !important;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    opacity: 0 !important;
    transform: translateY(30px) !important;
    border: 1px solid rgba(212, 175, 55, 0.3) !important;
    position: relative !important;
  }

  .prodotto-card-final::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 4px !important;
    background: linear-gradient(90deg, #ddbb76, #f1c40f, #ddbb76) !important;
    transform: scaleX(0) !important;
    transition: transform 0.3s ease !important;
    z-index: 2 !important;
  }

  .prodotto-card-final:hover::before {
    transform: scaleX(1) !important;
  }

  .prodotto-card-final.animate-in {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }

  .prodotto-card-final:hover {
    transform: translateY(-12px) scale(1.02) !important;
    box-shadow: 
      0 25px 60px rgba(0, 0, 0, 0.6),
      0 10px 30px rgba(212, 175, 55, 0.3) !important;
    border-color: rgba(212, 175, 55, 0.6) !important;
  }

  .prodotto-image {
    position: relative !important;
    height: 300px !important; /* Aumentata da 280px */
    overflow: hidden !important;
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%) !important;
    display: flex !important; /* Aggiunto per centrare l'immagine */
    align-items: center !important; /* Centra verticalmente */
    justify-content: center !important; /* Centra orizzontalmente */
  }

  .prodotto-image img {
    width: auto !important; /* Cambiato da 100% */
    height: auto !important; /* Cambiato da 100% */
    max-width: 100% !important; /* Aggiunto per rispettare la larghezza del container */
    max-height: 100% !important; /* Aggiunto per rispettare l'altezza del container */
    object-fit: contain !important; /* Cambiato da cover a contain */
    transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
  }

  .prodotto-card-final:hover .prodotto-image img {
    transform: scale(1.08) !important;
  }

  .badges {
    position: absolute !important;
    top: 15px !important;
    right: 15px !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    z-index: 3 !important;
  }

  .badge {
    padding: 8px 16px !important;
    border-radius: 20px !important;
    font-weight: 700 !important;
    font-size: 0.8rem !important;
    text-align: center !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    transition: all 0.3s ease !important;
  }

  .badge:hover {
    transform: scale(1.05) !important;
  }

  .badge.nuovo {
    background: linear-gradient(45deg, #27ae60, #2ecc71) !important;
    color: white !important;
  }

  .badge.limited {
    background: linear-gradient(45deg, #e67e22, #f39c12) !important;
    color: white !important;
  }

  .badge.sconto {
    background: linear-gradient(45deg, #ddbb76, #f1c40f) !important;
    color: #1a1a1a !important;
    font-weight: 800 !important;
  }

  .prodotto-content {
    padding: 30px !important;
    color: #e0e0e0 !important;
  }

  .prodotto-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: flex-start !important;
    margin-bottom: 16px !important;
    gap: 15px !important;
  }

  .prodotto-header h3 {
    font-size: 1.4rem !important;
    font-weight: 700 !important;
    color: #e0e0e0 !important;
    margin: 0 !important;
    line-height: 1.3 !important;
    flex: 1 !important;
  }

  .categoria-tag {
    background: linear-gradient(45deg, rgba(212, 175, 55, 0.1) 0%, rgba(241, 196, 15, 0.05) 100%) !important;
    color: #ddbb76 !important;
    padding: 6px 12px !important;
    border-radius: 15px !important;
    font-size: 0.8rem !important;
    font-weight: 600 !important;
    border: 1px solid rgba(212, 175, 55, 0.2) !important;
    white-space: nowrap !important;
  }

  .descrizione {
    color: #ccc !important;
    line-height: 1.6 !important;
    margin-bottom: 20px !important;
    font-size: 0.95rem !important;
  }

  .prezzi {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
    margin-bottom: 20px !important;
    flex-wrap: wrap !important;
    padding: 15px !important;
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(241, 196, 15, 0.05) 100%) !important;
    border-radius: 12px !important;
    border: 1px solid rgba(212, 175, 55, 0.2) !important;
  }

  .prezzo-originale {
    color: #888 !important;
    text-decoration: line-through !important;
    font-size: 1rem !important;
    font-weight: 500 !important;
  }

  .prezzo-scontato {
    color: #ddbb76 !important;
    font-size: 1.5rem !important;
    font-weight: 800 !important;
  }

  .risparmio {
    background: linear-gradient(45deg, #27ae60, #2ecc71) !important;
    color: white !important;
    padding: 4px 10px !important;
    border-radius: 12px !important;
    font-size: 0.85rem !important;
    font-weight: 600 !important;
  }

  .taglie {
    margin-bottom: 25px !important;
  }

  .taglie-label {
    display: block !important;
    color: #ccc !important;
    font-size: 0.9rem !important;
    font-weight: 600 !important;
    margin-bottom: 8px !important;
  }

  .taglie-list {
    display: flex !important;
    gap: 8px !important;
    flex-wrap: wrap !important;
  }

  .taglia {
    background: linear-gradient(135deg, rgba(248, 249, 250, 0.1) 0%, rgba(233, 236, 239, 0.1) 100%) !important;
    color: #e0e0e0 !important;
    padding: 6px 12px !important;
    border-radius: 12px !important;
    font-size: 0.85rem !important;
    font-weight: 600 !important;
    border: 1px solid rgba(212, 175, 55, 0.3) !important;
    transition: all 0.3s ease !important;
  }

  .taglia:hover {
    background: linear-gradient(135deg, #ddbb76 0%, #f1c40f 100%) !important;
    color: white !important;
    transform: scale(1.05) !important;
  }

  .prodotto-actions {
    display: flex !important;
    gap: 12px !important;
    flex-wrap: wrap !important;
  }

  .btn-whatsapp, .btn-call {
    flex: 1 !important;
    min-width: 140px !important;
    padding: 12px 20px !important;
    border-radius: 12px !important;
    text-decoration: none !important;
    font-weight: 600 !important;
    font-size: 0.9rem !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 8px !important;
    transition: all 0.3s ease !important;
    border: none !important;
    cursor: pointer !important;
  }

  .btn-whatsapp {
    background: linear-gradient(45deg, #25D366, #128C7E) !important;
    color: white !important;
    box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3) !important;
  }

  .btn-whatsapp:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4) !important;
    background: linear-gradient(45deg, #128C7E, #25D366) !important;
  }

  .btn-call {
    background: linear-gradient(45deg, #ddbb76, #f1c40f) !important;
    color: #1a1a1a !important;
    box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3) !important;
  }

  .btn-call:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4) !important;
    background: linear-gradient(45deg, #f1c40f, #ddbb76) !important;
  }

  /* CTA Saldi */
  .cta-saldi {
    padding: 80px 0;
    background: linear-gradient(135deg, #ddbb76, #f1c40f);
  }

  .cta-content {
    text-align: center;
    color: #1a1a1a;
  }

  .cta-content h2 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 20px;
  }

  .cta-content p {
    font-size: 1.2rem;
    margin-bottom: 40px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .cta-buttons {
    display: flex;
    gap: 20px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn-primary, .btn-secondary {
    padding: 16px 32px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    font-size: 1.1rem;
    transition: all 0.3s ease;
    min-width: 200px;
    text-align: center;
  }

  .btn-primary {
    background: #1a1a1a;
    color: white;
  }

  .btn-primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 30px rgba(26, 26, 26, 0.3);
  }

  .btn-secondary {
    background: transparent;
    color: #1a1a1a;
    border: 2px solid #1a1a1a;
  }

  .btn-secondary:hover {
    background: #1a1a1a;
    color: white;
    transform: translateY(-3px);
  }

  /* Filtri Categoria */
  .filtri-categoria {
    padding: 80px 0;
    background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
    border-bottom: 1px solid rgba(212, 175, 55, 0.2);
  }

  .filtri-categoria h2 {
    text-align: center;
    color: white;
    font-size: 2.5rem;
    margin-bottom: 50px;
    font-weight: 300;
  }

  .filtri-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    max-width: 1000px;
    margin: 0 auto;
  }

  .filtro-btn {
    background: rgba(26, 26, 26, 0.8);
    border: 2px solid rgba(212, 175, 55, 0.3);
    color: white;
    padding: 25px 20px;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .filtro-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
    transition: left 0.5s ease;
  }

  .filtro-btn:hover::before {
    left: 100%;
  }

  .filtro-btn:hover {
    border-color: rgba(212, 175, 55, 0.6);
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(212, 175, 55, 0.2);
  }

  .filtro-btn.active {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.8) 0%, rgba(212, 175, 55, 0.6) 100%);
    border-color: #ddbb76;
    color: #000;
    transform: translateY(-5px);
    box-shadow: 0 15px 40px rgba(212, 175, 55, 0.3);
  }

  .filtro-icon {
    font-size: 2rem;
    margin-bottom: 5px;
  }

  .filtro-text {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 5px;
  }

  .filtro-count {
    background: rgba(212, 175, 55, 0.2);
    color: #ddbb76;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .filtro-btn.active .filtro-count {
    background: rgba(0, 0, 0, 0.2);
    color: #000;
  }

  /* Effetto di nascondere/mostrare prodotti */
  .prodotto-card {
    transition: all 0.4s ease;
  }

  .prodotto-card.hidden {
    opacity: 0;
    transform: scale(0.8);
    pointer-events: none;
    margin: 0;
    height: 0;
    overflow: hidden;
  }

  .prodotto-card.hidden {
    display: none;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .categorie-grid {
      grid-template-columns: 1fr;
      gap: 30px;
    }

    .prodotti-grid {
      grid-template-columns: 1fr;
      gap: 30px;
    }

    .prodotto-card {
      max-width: 100%;
    }

    .categoria-image, .prodotto-image {
      height: 250px;
    }

    .prodotto-header {
      flex-direction: column;
      gap: 10px;
      align-items: flex-start;
    }

    .prezzi {
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
    }

    .prodotto-actions {
      flex-direction: column;
    }

    .hero-stats {
      flex-direction: column;
      gap: 30px;
    }    .hero-text h1 {
      font-size: 2.5rem;
    }

    /* Filtri responsive */
    .filtri-prodotti {
      padding: 60px 0 40px;
    }

    .filtri-container {
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    .filtro-btn {
      width: 100%;
      max-width: 300px;
      justify-content: space-between;
      padding: 14px 20px;
    }

    .filtro-text {
      white-space: normal;
      text-align: center;
      flex: 1;
    }

    .hero-text h2 {
      font-size: 1.4rem;
    }

    .categoria-content, .prodotto-content {
      padding: 20px;
    }
  }

  @media (max-width: 480px) {
    .categorie-grid {
      padding: 0 10px;
    }

    .prodotti-grid {
      padding: 0 10px;
    }

    .categoria-image, .prodotto-image {
      height: 200px;
    }

    .hero-text h1 {
      font-size: 2rem;
    }

    .sconto-overlay, .genere-badge, .genere-badge-prod {
      font-size: 0.8rem;
      padding: 6px 12px;
    }

    .badges {
      top: 10px;
      right: 10px;
    }  }

  .step-description {
    color: #666;
    font-size: 1rem;
    margin-top: 8px;
  }

  /* Breadcrumb */
  .breadcrumb {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 16px;
    font-size: 0.9rem;
    color: #666;
  }

  /* Sezione Post Saldi */
  .saldi-posts {
    padding: 100px 0;
    background: #0a0a0a;
  }

  .posts-header {
    text-align: center;
    margin-bottom: 80px;
    color: white;
  }

  .posts-header h2 {
    font-family: 'Glida Display Regular', 'Playfair Display', serif;
    font-size: 3rem;
    font-weight: 300;
    margin-bottom: 20px;
    letter-spacing: 2px;
    color: #ffffff;
  }

  .posts-header p {
    font-family: 'Inter', -apple-system, sans-serif;
    font-size: 1.1rem;
    color: rgba(255, 255, 255, 0.6);
    font-weight: 300;
    letter-spacing: 0.5px;
  }

  .posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 40px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .post-card {
    background: rgba(255, 255, 255, 0.02);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    padding: 40px;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .post-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 2px;
    height: 100%;
    background: linear-gradient(180deg, transparent, #ddbb76, transparent);
    transform: scaleY(0);
    transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .post-card:hover::before {
    transform: scaleY(1);
  }

  .post-card:hover {
    background: rgba(255, 255, 255, 0.04);
    border-color: rgba(212, 175, 55, 0.2);
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
  }

  .post-header h3 {
    font-family: 'Glida Display Regular', 'Playfair Display', serif;
    font-size: 1.8rem;
    font-weight: 300;
    color: #ffffff;
    margin-bottom: 10px;
    letter-spacing: 0.5px;
  }

  .post-header h4 {
    font-family: 'Inter', -apple-system, sans-serif;
    font-size: 1rem;
    font-weight: 300;
    color: rgba(212, 175, 55, 0.8);
    margin-bottom: 20px;
    letter-spacing: 0.5px;
  }

  .post-description {
    font-family: 'Inter', -apple-system, sans-serif;
    color: rgba(255, 255, 255, 0.6);
    line-height: 1.8;
    margin-bottom: 20px;
    font-weight: 300;
  }

  .post-date {
    display: flex;
    align-items: center;
    gap: 10px;
    color: rgba(212, 175, 55, 0.6);
    font-family: 'Inter', -apple-system, sans-serif;
    font-size: 0.9rem;
    font-weight: 300;
    letter-spacing: 0.5px;
  }

  .post-date svg {
    opacity: 0.6;
  }

  .post-number {
    position: absolute;
    top: 30px;
    right: 30px;
    font-family: 'Glida Display Regular', 'Playfair Display', serif;
    font-size: 3rem;
    font-weight: 300;
    color: rgba(212, 175, 55, 0.1);
    letter-spacing: 2px;
  }

  /* Responsive Post Saldi */
  @media (max-width: 768px) {
    .saldi-posts {
      padding: 60px 0;
    }

    .posts-header h2 {
      font-size: 2rem;
    }

    .posts-grid {
      grid-template-columns: 1fr;
      gap: 20px;
      padding: 0 20px;
    }

    .post-card {
      padding: 20px;
    }

    .post-header h3 {
      font-size: 1.3rem;
    }

    .post-number {
      width: 40px;
      height: 40px;
      font-size: 0.9rem;
    }
  }

  .breadcrumb-item {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .breadcrumb-item.active {
    color: #ddbb76;
    font-weight: 600;
  }

  .breadcrumb-separator {
    color: #999;
    font-weight: 300;
  }

  .breadcrumb strong {
    color: #333;
    font-weight: 600;
  }

  /* Contatore Prodotti */
  .prodotti-contatore {
    grid-column: 1 / -1;
    text-align: center;
    margin-bottom: 30px;
    padding: 20px;
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(241, 196, 15, 0.05) 100%);
    border-radius: 15px;
    border: 1px solid rgba(212, 175, 55, 0.2);
  }

  .contatore-numero {
    display: block;
    font-size: 2.5rem;
    font-weight: 700;
    color: #ddbb76;
    line-height: 1;
  }

  .contatore-testo {
    display: block;
    font-size: 1rem;
    color: #666;
    margin-top: 8px;
  }

  /* Nessun Prodotto */
  .nessun-prodotto {
    grid-column: 1 / -1;
    text-align: center;
    padding: 60px 20px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 15px;
    border: 1px solid rgba(212, 175, 55, 0.1);
  }

  .nessun-prodotto-icon {
    font-size: 4rem;
    margin-bottom: 20px;
  }

  .nessun-prodotto h3 {
    font-size: 1.5rem;
    color: #333;
    margin-bottom: 10px;
  }

  .nessun-prodotto p {
    color: #666;
    margin-bottom: 30px;
  }

  .btn-torna-categorie {
    background: linear-gradient(45deg, #ddbb76, #f1c40f);
    color: #1a1a1a;
    border: none;
    padding: 12px 24px;
    border-radius: 25px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .btn-torna-categorie:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
  }

  /* STILI CARD CATEGORIE E PRODOTTI - LUXURY THEME */
  .categoria-card-step {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%);
    backdrop-filter: blur(20px);
    color: #e0e0e0;
    border: 2px solid rgba(255, 215, 0, 0.3);
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4), 0 5px 15px rgba(255, 215, 0, 0.1);
    padding: 32px;
    display: flex;
    align-items: center;
    gap: 24px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }
  
  .categoria-card-step::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #ddbb76, #c6ae6a, #ddbb76);
    transform: scaleX(0);
    transition: transform 0.3s ease;
  }
  
  .categoria-card-step:hover::before {
    transform: scaleX(1);
  }
  
  .categoria-card-step .categoria-icon {
    font-size: 2.5rem;
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 215, 0, 0.05) 100%);
    color: #ddbb76;
    border-radius: 20px;
    width: 70px;
    height: 70px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(255, 215, 0, 0.3);
    transition: all 0.3s ease;
    flex-shrink: 0;
  }
  
  .categoria-card-step .categoria-info h3 {
    color: #e0e0e0;
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 8px;
  }
  
  .categoria-card-step .categoria-info p {
    color: #ccc;
    margin-bottom: 12px;
  }
  
  .categoria-card-step .sconto-badge {
    background: linear-gradient(45deg, #ddbb76, #c6ae6a);
    color: #1a1a1a;
    border-radius: 12px;
    padding: 4px 10px;
    font-weight: 600;
    font-size: 0.8rem;
  }
  
  .categoria-card-step .prodotti-count {
    color: #ccc;
    font-size: 0.9rem;
  }

  .prodotto-card-final {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%) !important;
    color: #e0e0e0 !important;
  }
  .prodotto-card-final .prodotto-header h3 {
    color: #e0e0e0 !important;
  }
  .prodotto-card-final .descrizione {
    color: #ccc !important;
  }
  .prodotto-card-final .categoria-tag {
    color: #ddbb76 !important;
    background: rgba(212, 175, 55, 0.15) !important;
  }
  .prodotto-card-final .prezzo-scontato {
    color: #ddbb76 !important;
  }
  .prodotto-card-final .prezzo-originale {
    color: #888 !important;
  }
  .prodotto-card-final .risparmio {
    color: #fff !important;
    background: #27ae60 !important;
  }

  /* HOVER EFFECTS PER CARD - LUXURY THEME */
  .categoria-card-step:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.6), 0 10px 30px rgba(255, 215, 0, 0.3);
    border-color: rgba(255, 215, 0, 0.6);
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.98) 0%, rgba(13, 13, 13, 0.95) 100%);
  }
  
  .categoria-card-step:hover .categoria-icon {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 215, 0, 0.1) 100%);
    border-color: rgba(255, 215, 0, 0.5);
    transform: scale(1.1);
  }

  .prodotto-card-final:hover {
    transform: translateY(-8px) scale(1.02) !important;
    box-shadow: 0 20px 50px rgba(0,0,0,0.6) !important;
    border-color: rgba(212,175,55,0.6) !important;
  }

  .prodotto-card-final:hover .prodotto-image img {
    transform: scale(1.1) !important;
  }

  .btn-whatsapp:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4) !important;
  }

  .btn-call:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 25px rgba(212,175,55,0.4) !important;
  }

  /* PRODOTTO CARD COMPACT - STILI MANCANTI */
  .prodotto-card-compact {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%);
    color: #e0e0e0;
    backdrop-filter: blur(20px);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), 0 4px 10px rgba(212, 175, 55, 0.1);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    opacity: 0 !important;
    transform: translateY(20px) !important;
    border: 1px solid rgba(212, 175, 55, 0.2);
    position: relative;
    min-height: 420px;
  }

  .prodotto-card-compact.animate-in {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }

  .prodotto-card-compact:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6), 0 8px 20px rgba(212, 175, 55, 0.3);
    border-color: rgba(212, 175, 55, 0.5);
  }

  .prodotto-image-compact {
    position: relative;
    height: 180px;
    overflow: hidden;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  }

  .prodotto-image-compact img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .prodotto-card-compact:hover .prodotto-image-compact img {
    transform: scale(1.08);
  }

  .badges-compact {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    z-index: 3;
  }

  .badges-compact .badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 0.7rem;
    text-align: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .badges-compact .badge.nuovo {
    background: linear-gradient(45deg, #27ae60, #2ecc71);
    color: white;
  }

  .badges-compact .badge.limited {
    background: linear-gradient(45deg, #e67e22, #f39c12);
    color: white;
  }

  .badges-compact .badge.sconto {
    background: linear-gradient(45deg, #ddbb76, #c6ae6a);
    color: #1a1a1a;
    font-weight: 700;
  }

  .prodotto-content-compact {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    height: calc(100% - 180px);
  }

  .prodotto-header-compact {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 10px;
    margin-bottom: 8px;
  }

  .prodotto-header-compact h3 {
    font-size: 1.1rem;
    font-weight: 600;
    color: #e0e0e0;
    margin: 0;
    line-height: 1.3;
    flex: 1;
  }

  .prodotto-header-compact .categoria-tag {
    background: linear-gradient(45deg, rgba(212, 175, 55, 0.15) 0%, rgba(241, 196, 15, 0.1) 100%);
    color: #ddbb76;
    padding: 4px 8px;
    border-radius: 10px;
    font-size: 0.7rem;
    font-weight: 600;
    border: 1px solid rgba(212, 175, 55, 0.3);
    white-space: nowrap;
  }

  .prezzi-compact {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    padding: 10px;
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(241, 196, 15, 0.05) 100%);
    border-radius: 8px;
    border: 1px solid rgba(212, 175, 55, 0.2);
    margin-bottom: 8px;
  }

  .prezzi-compact .prezzo-originale {
    color: #888;
    text-decoration: line-through;
    font-size: 0.9rem;
    font-weight: 500;
  }

  .prezzi-compact .prezzo-scontato {
    color: #ddbb76;
    font-size: 1.2rem;
    font-weight: 700;
  }

  .prezzi-compact .risparmio {
    background: linear-gradient(45deg, #27ae60, #2ecc71);
    color: white;
    padding: 2px 6px;
    border-radius: 8px;
    font-size: 0.7rem;
    font-weight: 600;
    margin-left: auto;
  }

  .taglie-compact {
    margin-bottom: 12px;
  }

  .taglie-compact .taglie-label {
    display: block;
    color: #ccc;
    font-size: 0.8rem;
    font-weight: 600;
    margin-bottom: 6px;
  }

  .taglie-compact .taglie-list {
    display: flex;
    gap: 4px;
    flex-wrap: wrap;
    justify-content: center;
  }

  .taglie-compact .taglia {
    background: rgba(212, 175, 55, 0.15);
    color: #e0e0e0;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 0.75rem;
    font-weight: 600;
    border: 1px solid rgba(212, 175, 55, 0.3);
    transition: all 0.3s ease;
    min-width: 30px;
    text-align: center;
  }

  .taglie-compact .taglia:hover {
    background: linear-gradient(135deg, #ddbb76 0%, #c6ae6a 100%);
    color: #1a1a1a;
    transform: scale(1.05);
  }

  .prodotto-actions-compact {
    display: flex;
    gap: 8px;
    margin-top: auto;
  }

  .btn-whatsapp-compact,
  .btn-call-compact {
    flex: 1;
    padding: 8px 12px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
  }

  .btn-whatsapp-compact {
    background: linear-gradient(45deg, #25D366, #128C7E);
    color: white;
    box-shadow: 0 2px 8px rgba(37, 211, 102, 0.3);
  }

  .btn-whatsapp-compact:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
  }

  .btn-call-compact {
    background: linear-gradient(45deg, #ddbb76, #c6ae6a);
    color: #1a1a1a;
    box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
  }

  .btn-call-compact:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
  }

  /* NESSUN PRODOTTO STYLES */
  .nessun-prodotto {
    text-align: center;
    padding: 60px 20px;
    color: #ccc;
    grid-column: 1 / -1;
  }

  .nessun-prodotto-icon {
    font-size: 4rem;
    margin-bottom: 20px;
  }

  .nessun-prodotto h3 {
    font-size: 1.8rem;
    color: #e0e0e0;
    margin-bottom: 15px;
  }

  .nessun-prodotto p {
    font-size: 1.1rem;
    margin-bottom: 30px;
  }

  .btn-torna-categorie {
    background: linear-gradient(45deg, #ddbb76, #c6ae6a);
    color: #1a1a1a;
    padding: 12px 24px;
    border-radius: 12px;
    border: none;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .btn-torna-categorie:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(255, 215, 0, 0.4);
  }

  /* RESPONSIVIT√Ä EXTRA PER STILI INLINE */
  @media (max-width: 768px) {
    .categoria-card-step:hover {
      transform: translateY(-3px) scale(1.01) !important;
    }
    
    .prodotto-card-final:hover {
      transform: translateY(-5px) scale(1.01) !important;
    }

    .prodotto-card-compact:hover {
      transform: translateY(-4px) scale(1.01);
    }

    .prodotto-card-compact {
      min-height: 380px;
    }

    .prodotto-content-compact {
      padding: 16px;
    }

    .prodotto-actions-compact {
      flex-direction: column;
      gap: 6px;
    }
  }

  @media (max-width: 768px) {
    .step-header {
      flex-direction: column;
      align-items: center;
      gap: 20px;
      position: relative;
    }

    .btn-back {
      position: absolute;
      top: 0;
      left: 0;
      transform: none;
      padding: 10px 16px;
      font-size: 0.9rem;
    }

    .step-info {
      width: 100%;
      padding-top: 60px;
    }
  }

  @media (max-width: 480px) {
    .categoria-card-step:hover,
    .prodotto-card-final:hover {
      transform: none !important;
    }

    .btn-back {
      padding: 8px 12px;
      font-size: 0.85rem;
    }
  }
</style>

<script>
// Test JavaScript immediato
console.log('üéØ Script caricato immediatamente');

// Sistema di navigazione a step per i saldi
document.addEventListener('DOMContentLoaded', function() {
  console.log('üöÄ DOMContentLoaded triggered');
  
  // Prima di tutto, controlliamo se i saldi sono attivi
  const selezioneSection = document.querySelector('.selezione-saldi');
  if (!selezioneSection) {
    console.log('‚ùå Sezione selezione saldi non trovata - probabilmente i saldi non sono attivi');
    return;
  }
  
  console.log('‚úÖ Sezione selezione saldi trovata');
  
  // Test di base - controllo DOM
  const genereCards = document.querySelectorAll('.genere-card');
  console.log('üë§ Card genere trovate:', genereCards.length);
  
  // Debug specifico per ogni card
  genereCards.forEach((card, index) => {
    console.log(`Card ${index}:`, {
      element: card,
      genere: card.getAttribute('data-genere'),
      classList: card.className,
      visible: card.offsetWidth > 0 && card.offsetHeight > 0
    });
  });
  
  if (genereCards.length === 0) {
    console.error('‚ùå Nessuna card genere trovata! DOM potrebbe non essere pronto.');
    // Debug - controlliamo se l'elemento step-genere esiste
    const stepGenere = document.getElementById('step-genere');
    console.log('Step genere element:', stepGenere);
    if (stepGenere) {
      console.log('HTML step-genere:', stepGenere.innerHTML);
    }
    return;
  }
  
  // Carica i dati dal JSON
  const saldiDataElement = document.getElementById('saldi-data');
  
  if (!saldiDataElement) {
    console.error('‚ùå Elemento saldi-data non trovato!');
    return;
  }
  
  console.log('‚úÖ Elemento saldi-data trovato');
  
  let saldiData;
  try {
    saldiData = JSON.parse(saldiDataElement.textContent);
    console.log('üìä Dati Saldi caricati:', saldiData);
  } catch (error) {
    console.error('‚ùå Errore parsing JSON:', error);
    console.log('JSON content:', saldiDataElement.textContent);
    return;
  }
  
  let genereSelezionato = null;
  let categoriaSelezionata = null;
    
    // Controlla se le card genere esistono

    console.log('üë§ Card genere trovate:', genereCards.length);
      // Gestione click su card genere
    console.log('üéØ Aggiungendo event listener alle card genere...');
    
    genereCards.forEach((card, index) => {
      console.log(`üìù Aggiungendo listener a card ${index}:`, card.getAttribute('data-genere'));
      
      // Test click immediato per debug
      card.style.cursor = 'pointer';
      card.style.border = '2px solid #ddbb76';
      
      card.addEventListener('click', function(event) {
        console.log('üéØ CLICK RILEVATO su card genere!', this.getAttribute('data-genere'));
        console.log('Event object:', event);
        
        genereSelezionato = this.getAttribute('data-genere');
        console.log('üö∫üöπ Genere selezionato:', genereSelezionato);
        
        // Aggiorna stile card selezionata
        document.querySelectorAll('.genere-card').forEach(c => c.classList.remove('selected'));
        this.classList.add('selected');
        
        // Passa al step categorie
        setTimeout(() => {
          console.log('‚è±Ô∏è Timeout scaduto, chiamando mostraStepCategorie()');
          mostraStepCategorie();
        }, 300);
      });
      
      console.log(`‚úÖ Listener aggiunto alla card ${index}`);
    });
      // Funzione per mostrare step categorie
    function mostraStepCategorie() {
      console.log('üè∑Ô∏è mostraStepCategorie() chiamata');
      console.log('üîç Genere selezionato:', genereSelezionato);
      console.log('üìä Tutte le categorie disponibili:', saldiData.categorie);
      
      document.getElementById('step-genere').classList.remove('active');
      document.getElementById('step-categoria').classList.add('active');
      
      // Aggiorna breadcrumb
      document.getElementById('breadcrumb-genere').textContent = genereSelezionato;
      document.getElementById('breadcrumb-genere-prodotti').textContent = genereSelezionato;
      
      // Popola le categorie per il genere selezionato
      const categorieContainer = document.getElementById('categorie-per-genere');
      const categoriePerGenere = saldiData.categorie.filter(cat => cat.genere === genereSelezionato);
      
      console.log('üéØ Categorie filtrate per genere:', categoriePerGenere);
      
      categorieContainer.innerHTML = '';
      
      // Aggiungi opzione "Tutti gli articoli"
      const tuttiProdottiCount = saldiData.prodotti.filter(p => p.genere === genereSelezionato).length;
      
      if (tuttiProdottiCount > 0) {
        const tuttiArticoliHTML = `
          <div class="categoria-card-step tutti-articoli" data-categoria="Tutti gli articoli" data-genere="${genereSelezionato}" style="background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%); color: #e0e0e0; border: 2px solid rgba(255, 215, 0, 0.4); border-radius: 20px; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4), 0 5px 15px rgba(255, 215, 0, 0.2); padding: 32px; display: flex; align-items: center; gap: 24px; backdrop-filter: blur(20px); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer; position: relative; overflow: hidden; min-height: 120px;">
            <div class="categoria-icon" style="font-size: 2.5rem; background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 215, 0, 0.1) 100%); color: #ddbb76; border-radius: 20px; width: 70px; height: 70px; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(255, 215, 0, 0.3); transition: all 0.3s ease; flex-shrink: 0; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);">üõçÔ∏è</div>
            <div class="categoria-info" style="flex: 1;">
              <h3 style="color: #e0e0e0; font-size: 1.3rem; font-weight: 700; margin-bottom: 8px;">Tutti gli articoli</h3>
              <p style="color: #ccc; margin-bottom: 12px;">Visualizza tutti i prodotti in saldo per ${genereSelezionato.toLowerCase()}</p>
              <div class="categoria-meta" style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                <span class="sconto-badge" style="background: linear-gradient(45deg, #ddbb76, #c6ae6a); color: #1a1a1a; border-radius: 12px; padding: 4px 10px; font-weight: 600; font-size: 0.8rem; box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);">Offerte speciali</span>
                <span class="prodotti-count" style="color: #ccc; font-size: 0.9rem; background: rgba(255, 215, 0, 0.1); padding: 4px 8px; border-radius: 8px; border: 1px solid rgba(255, 215, 0, 0.2);">${tuttiProdottiCount} prodotti</span>
              </div>
            </div>
          </div>
        `;
        
        categorieContainer.innerHTML += tuttiArticoliHTML;
        console.log('‚úÖ Aggiunta opzione "Tutti gli articoli"');
      }
      
      if (categoriePerGenere.length === 0) {
        console.warn('‚ö†Ô∏è Nessuna categoria trovata per il genere:', genereSelezionato);
        if (tuttiProdottiCount === 0) {
          categorieContainer.innerHTML = '<p>Nessun prodotto disponibile per questo genere.</p>';
        }
        return;
      }
      
      categoriePerGenere.forEach((categoria, index) => {
        console.log(`üè∑Ô∏è Aggiungendo categoria ${index}:`, categoria);
        
        const prodottiPerCategoria = saldiData.prodotti.filter(p => 
          p.categoria === categoria.nome && p.genere === categoria.genere
        );
        
        console.log(`üì¶ Prodotti per ${categoria.nome}:`, prodottiPerCategoria.length);
        
        const categoriaHTML = `
          <div class="categoria-card-step" data-categoria="${categoria.nome}" data-genere="${categoria.genere}" style="background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%); color: #e0e0e0; border: 2px solid rgba(255, 215, 0, 0.4); border-radius: 20px; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4), 0 5px 15px rgba(255, 215, 0, 0.2); padding: 32px; display: flex; align-items: center; gap: 24px; backdrop-filter: blur(20px); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer; position: relative; overflow: hidden; min-height: 120px;">
            <div class="categoria-icon" style="font-size: 2.5rem; background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 215, 0, 0.1) 100%); color: #ddbb76; border-radius: 20px; width: 70px; height: 70px; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(255, 215, 0, 0.3); transition: all 0.3s ease; flex-shrink: 0; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);">${categoria.emoji}</div>
            <div class="categoria-info" style="flex: 1;">
              <h3 style="color: #e0e0e0; font-size: 1.3rem; font-weight: 700; margin-bottom: 8px;">${categoria.nome}</h3>
              <p style="color: #ccc; margin-bottom: 12px;">${categoria.descrizione}</p>
              <div class="categoria-meta" style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                <span class="sconto-badge" style="background: linear-gradient(45deg, #ddbb76, #c6ae6a); color: #1a1a1a; border-radius: 12px; padding: 4px 10px; font-weight: 600; font-size: 0.8rem; box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);">Sconto ${categoria.sconto}</span>
                <span class="prodotti-count" style="color: #ccc; font-size: 0.9rem; background: rgba(255, 215, 0, 0.1); padding: 4px 8px; border-radius: 8px; border: 1px solid rgba(255, 215, 0, 0.2);">${prodottiPerCategoria.length} prodotti</span>
              </div>
            </div>
          </div>
        `;
          
        categorieContainer.innerHTML += categoriaHTML;
      });
        // Aggiungi event listener alle nuove card categorie
      console.log('üéØ Aggiungendo event listener alle card categorie...');
      const categorieCards = document.querySelectorAll('.categoria-card-step');
      console.log('üè∑Ô∏è Card categorie trovate:', categorieCards.length);
      
      categorieCards.forEach((card, index) => {
        console.log(`üìù Aggiungendo listener a card categoria ${index}:`, card.getAttribute('data-categoria'));
        
        card.addEventListener('click', function() {
          categoriaSelezionata = this.getAttribute('data-categoria');
          console.log('üè∑Ô∏è Categoria selezionata:', categoriaSelezionata);
          
          // Aggiorna stile card selezionata
          document.querySelectorAll('.categoria-card-step').forEach(c => c.classList.remove('selected'));
          this.classList.add('selected');
          
          // Passa al step prodotti
          setTimeout(() => {
            console.log('‚è±Ô∏è Passando ai prodotti...');
            mostraStepProdotti();
          }, 300);
        });
      });
      
      // Scroll smooth al container
      document.getElementById('step-categoria').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      });
    }
    
    // Funzione per mostrare step prodotti
    function mostraStepProdotti() {
      document.getElementById('step-categoria').classList.remove('active');
      document.getElementById('step-prodotti').classList.add('active');
      
      // Aggiorna titolo
      const titoloProdotti = categoriaSelezionata === "Tutti gli articoli" 
        ? `üõçÔ∏è Tutti gli articoli - ${genereSelezionato}`
        : `üõçÔ∏è ${categoriaSelezionata} - ${genereSelezionato}`;
      
      const descrizioneProdotti = categoriaSelezionata === "Tutti gli articoli"
        ? `Scopri tutti i prodotti in saldo per ${genereSelezionato.toLowerCase()}`
        : `Scopri i migliori prodotti in saldo per ${genereSelezionato.toLowerCase()}`;
      
      document.getElementById('titolo-prodotti').textContent = titoloProdotti;
      document.getElementById('descrizione-prodotti').textContent = descrizioneProdotti;
      
      // Aggiorna breadcrumb categoria
      document.getElementById('breadcrumb-categoria').textContent = categoriaSelezionata;
      
      // Filtra e mostra prodotti
      let prodottiFiltrati;
      if (categoriaSelezionata === "Tutti gli articoli") {
        // Mostra tutti i prodotti del genere selezionato
        prodottiFiltrati = saldiData.prodotti.filter(p => p.genere === genereSelezionato);
      } else {
        // Filtra per categoria e genere specifici
        prodottiFiltrati = saldiData.prodotti.filter(p => 
        p.categoria === categoriaSelezionata && p.genere === genereSelezionato
      );
      }
      
      console.log(`üì¶ Prodotti filtrati per ${categoriaSelezionata}:`, prodottiFiltrati.length);
      
      // Aggiorna contatore nel header
      const headerCounter = document.getElementById('prodotti-trovati-header');
      const headerNumber = document.getElementById('numero-prodotti-header');
      if (headerCounter && headerNumber) {
        headerNumber.textContent = prodottiFiltrati.length;
        headerCounter.style.display = 'inline';
      }
      
      const prodottiContainer = document.getElementById('prodotti-filtrati');
      prodottiContainer.innerHTML = '';
      
      if (prodottiFiltrati.length === 0) {
        const nessunProdottoHTML = `
          <div class="nessun-prodotto">
            <div class="nessun-prodotto-icon">üòî</div>
            <h3>Nessun prodotto disponibile</h3>
            <p>Non ci sono prodotti in saldo per la selezione corrente.</p>
            <button class="btn-torna-categorie" onclick="tornaAlleCategorie()">
              ‚Üê Torna alle categorie
            </button>
          </div>
        `;
        prodottiContainer.innerHTML += nessunProdottoHTML;
        return;
      }
      
      prodottiFiltrati.forEach((prodotto, index) => {
        const scontoCalcolato = Math.round(((prodotto.prezzoOriginale - prodotto.prezzoScontato) / prodotto.prezzoOriginale) * 100);
        
        const taglieHTML = prodotto.taglie ? prodotto.taglie.map(t => `<span class="taglia" style="background: rgba(212,175,55,0.2); color: #ffffff; padding: 6px 10px; border-radius: 8px; font-size: 0.75rem; font-weight: 700; border: 1px solid rgba(212,175,55,0.4); transition: all 0.3s ease; min-width: 32px; text-align: center; box-shadow: 0 1px 4px rgba(212,175,55,0.2);">${t}</span>`).join('') : '';
        
        const cardHTML = `
          <div class="prodotto-card-compact" data-delay="${index * 0.1}" style="background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%); color: #e0e0e0; backdrop-filter: blur(20px); border-radius: 16px; overflow: hidden; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), 0 4px 10px rgba(212, 175, 55, 0.1); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 1px solid rgba(212, 175, 55, 0.2); position: relative; min-height: 440px; width: 320px; max-width: 320px; min-width: 320px; margin: 0 auto;">
            <div class="prodotto-image-compact" style="position: relative; height: 200px; overflow: hidden; background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(13, 13, 13, 0.9) 100%); display: flex; align-items: center; justify-content: center;">
              <img src="${prodotto.immagine || '/uploads/optimized/background.webp'}" alt="${prodotto.nome}" style="width: auto; height: auto; max-width: 100%; max-height: 100%; object-fit: contain; transition: transform 0.5s ease;" />
              <div class="badges-compact" style="position: absolute; top: 10px; right: 10px; display: flex; flex-direction: column; gap: 6px; z-index: 3;">
                ${prodotto.nuovo ? '<span class="badge nuovo" style="padding: 4px 8px; border-radius: 12px; font-weight: 600; font-size: 0.7rem; text-align: center; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); background: linear-gradient(45deg, #27ae60, #2ecc71); color: white;">Nuovo</span>' : ''}
                ${prodotto.limitedTime ? '<span class="badge limited" style="padding: 4px 8px; border-radius: 12px; font-weight: 600; font-size: 0.7rem; text-align: center; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); background: linear-gradient(45deg, #e67e22, #f39c12); color: white;">Limitato</span>' : ''}
                <span class="badge sconto" style="padding: 4px 8px; border-radius: 12px; font-weight: 700; font-size: 0.7rem; text-align: center; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); background: linear-gradient(45deg, #ddbb76, #c6ae6a); color: #1a1a1a;">-${scontoCalcolato}%</span>
              </div>
            </div>
            
            <div class="prodotto-content-compact" style="padding: 20px; display: flex; flex-direction: column; gap: 12px; height: calc(100% - 200px);">
              <div class="prodotto-header-compact" style="margin-bottom: 12px; text-align: center;">
                <h3 style="font-size: 1.2rem; font-weight: 700; color: #ffffff; margin: 0 0 8px 0; line-height: 1.3; letter-spacing: 0.3px;">${prodotto.nome}</h3>
                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; flex-wrap: wrap;">
                  <span class="categoria-tag" style="background: linear-gradient(45deg, #ddbb76 0%, #f1c40f 100%); color: #1a1a1a; padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 700; box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3); white-space: nowrap; text-transform: uppercase; letter-spacing: 0.5px;">${prodotto.categoria}</span>
                  <div style="width: 4px; height: 4px; background: rgba(255, 215, 0, 0.5); border-radius: 50%; flex-shrink: 0;"></div>
                  <span style="color: rgba(255, 255, 255, 0.7); font-size: 0.8rem; font-weight: 500;">${prodotto.genere}</span>
                </div>
              </div>
              
              <div class="prezzi-compact" style="display: flex; align-items: center; justify-content: center; gap: 8px; flex-wrap: wrap; padding: 12px; background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(241, 196, 15, 0.08) 100%); border-radius: 12px; border: 1px solid rgba(212, 175, 55, 0.3); margin-bottom: 8px; text-align: center;">
                <span class="prezzo-originale" style="color: #888; text-decoration: line-through; font-size: 0.9rem; font-weight: 500;">‚Ç¨${prodotto.prezzoOriginale}</span>
                <span class="prezzo-scontato" style="color: #ddbb76; font-size: 1.3rem; font-weight: 800; text-shadow: 0 0 4px rgba(255, 215, 0, 0.3);">‚Ç¨${prodotto.prezzoScontato}</span>
                <span class="risparmio" style="background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; padding: 3px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 700; box-shadow: 0 2px 6px rgba(39, 174, 96, 0.3);">-‚Ç¨${(prodotto.prezzoOriginale - prodotto.prezzoScontato).toFixed(2)}</span>
              </div>
              
              <div class="taglie-compact" style="margin-bottom: 12px; text-align: center;">
                <span class="taglie-label" style="display: block; color: #ccc; font-size: 0.8rem; font-weight: 600; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Taglie disponibili</span>
                <div class="taglie-list" style="display: flex; gap: 6px; flex-wrap: wrap; justify-content: center; align-items: center;">${taglieHTML}</div>
              </div>
              
              <div class="prodotto-actions-compact" style="display: flex; gap: 8px; margin-top: auto;">
                <a href="https://wa.me/393272271295?text=Ciao! Sono interessato al prodotto: ${prodotto.nome}. Potreste darmi maggiori informazioni?" target="_blank" class="btn-whatsapp-compact" style="flex: 1; padding: 8px 12px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; gap: 6px; transition: all 0.3s ease; border: none; cursor: pointer; background: linear-gradient(45deg, #25D366, #128C7E); color: white; box-shadow: 0 2px 8px rgba(37, 211, 102, 0.3);">
                  <svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.787"/>
                  </svg>
                  WhatsApp
                </a>
                <a href="tel:0882302070" class="btn-call-compact" style="flex: 1; padding: 8px 12px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; gap: 6px; transition: all 0.3s ease; border: none; cursor: pointer; background: linear-gradient(45deg, #ddbb76, #c6ae6a); color: #1a1a1a; box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);">
                  <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                  </svg>
                  Chiama
                </a>
              </div>
            </div>
          </div>
        `;
        
        prodottiContainer.innerHTML += cardHTML;
      });
      
      // Animazioni di entrata
      setTimeout(() => {
        document.querySelectorAll('.prodotto-card-compact').forEach((card, index) => {
          setTimeout(() => {
            card.classList.add('animate-in');
          }, index * 50);
        });
      }, 100);
      
      // Scroll smooth al container
      document.getElementById('step-prodotti').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      });
    }
    
    // Funzioni di navigazione indietro
    window.tornaAlGenere = function() {
      document.getElementById('step-categoria').classList.remove('active');
      document.getElementById('step-genere').classList.add('active');
      genereSelezionato = null;
      
      // Reset selezioni
      document.querySelectorAll('.genere-card').forEach(c => c.classList.remove('selected'));
    };
    
    window.tornaAlleCategorie = function() {
      document.getElementById('step-prodotti').classList.remove('active');
      document.getElementById('step-categoria').classList.add('active');
      categoriaSelezionata = null;
      
      // Reset selezioni
      document.querySelectorAll('.categoria-card-step').forEach(c => c.classList.remove('selected'));
    };
  });
</script>
